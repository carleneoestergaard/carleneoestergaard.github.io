<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/build/blog/rss.xml" title="Inviso Alteryx Documetation Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/build/blog/atom.xml" title="Inviso Alteryx Documetation Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Inviso Alteryx Documetation" href="/build/opensearch.xml"><title data-react-helmet="true">Microsoft Dynamics | Inviso Alteryx Documetation</title><meta data-react-helmet="true" property="og:url" content="https://carleneoestergaard.github.io/build/docs/Connections/Microsoft Dynamics"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Microsoft Dynamics | Inviso Alteryx Documetation"><meta data-react-helmet="true" name="description" content="Alteryx to Microsoft Dynamics CRM"><meta data-react-helmet="true" property="og:description" content="Alteryx to Microsoft Dynamics CRM"><link data-react-helmet="true" rel="shortcut icon" href="/build/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://carleneoestergaard.github.io/build/docs/Connections/Microsoft Dynamics"><link data-react-helmet="true" rel="alternate" href="https://carleneoestergaard.github.io/build/docs/Connections/Microsoft Dynamics" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://carleneoestergaard.github.io/build/docs/Connections/Microsoft Dynamics" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://YOUR_APP_ID-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/build/assets/css/styles.834fdf0d.css">
<link rel="preload" href="/build/assets/js/runtime~main.11a58632.js" as="script">
<link rel="preload" href="/build/assets/js/main.5de3d1d2.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/build/"><img src="/build/img/Inviso_Logo.png" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/build/img/Inviso_Logo.png" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Documentation</strong></a><a class="navbar__item navbar__link navbar__link--active" href="/build/docs/intro">Alteryx</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/build/"><img src="/build/img/Inviso_Logo.png" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/build/img/Inviso_Logo.png" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Documentation</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/build/docs/intro">Alteryx</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/build/docs/intro">Intro</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Connections</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/build/docs/Connections/Bubble">Bubble</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/build/docs/Connections/Economic">Economic</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/build/docs/Connections/Fixer.io">Fixer.io</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/build/docs/Connections/Forecast">Harvest</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/build/docs/Connections/Hubspot">HubSpot</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/build/docs/Connections/Maconomy">Maconomy</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/build/docs/Connections/Microsoft Dynamics">Microsoft Dynamics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/build/docs/Connections/Oracle">Oracle Databases</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/build/docs/Connections/Rackbeat">Rackbeat</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/build/docs/Connections/Snowflake">Snowflake</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/build/docs/Connections/WebCRM">WebCRM</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Alteyx Server API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/build/docs/AlteryxAPI/general">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/build/docs/AlteryxAPI/permissions">Permissions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/build/docs/AlteryxAPI/frompython">API from Python</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/build/docs/AlteryxAPI/frompowershell">API from Powershell</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tutorial - Basics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/build/docs/tutorial-basics/create-a-page">Create a Page</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/build/docs/tutorial-basics/create-a-document">Create a Document</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/build/docs/tutorial-basics/create-a-blog-post">Create a Blog Post</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/build/docs/tutorial-basics/markdown-features">Markdown Features</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/build/docs/tutorial-basics/deploy-your-site">Deploy your site</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/build/docs/tutorial-basics/congratulations">Congratulations!</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tutorial - Extras</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/build/docs/tutorial-extras/manage-docs-versions">Manage Docs Versions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/build/docs/tutorial-extras/translate-your-site">Translate your site</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Microsoft Dynamics</h1></header><div class="markdown"><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="alteryx-to-microsoft-dynamics-crm"></a>Alteryx to Microsoft Dynamics CRM<a class="hash-link" href="#alteryx-to-microsoft-dynamics-crm" title="Direct link to heading">#</a></h3><p>Connecting Alteryx to Dynamics requires quite a bit of initial setup, which is described in detail in the next section.
After this initial setup there are then 2 ways to connect to Dynamics as you can either:</p><ol><li>Create your own macro / utilize the Inviso made macros provided in the download link </li><li>Use the Microsoft Dynamics tools from the gallery. </li></ol><p>Beware that the tools from the gallery cause Alteryx to run quite slow, whereby it will often be preferable to create your own macro.</p><p>In either option you will need to know which entity (table in Dynamics) you want to download.</p><p>Download the Inviso Alteryx Macros <a href="https://drive.google.com/file/d/1yMkMkaS9Qzb58Ltz4s6gIpcn91PA1PAq/view?usp=sharing" target="_blank" rel="noopener noreferrer">here</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="initial-setup"></a>Initial setup<a class="hash-link" href="#initial-setup" title="Direct link to heading">#</a></h2><p>The initial setup should be done by the IT Admin.</p><p>NOTE: Some entries in this guide have been covered / removed to protect and anonymise the client. These are either blurred or changed to either COMPANYNAME or HIDDEN.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="azure-ad-app"></a>Azure AD App<a class="hash-link" href="#azure-ad-app" title="Direct link to heading">#</a></h3><p>The first thing you need to do is to create an Azure AD app. To do that, go to Azure AD, and click on App Registrations (not Enterprise applications). </p><p><img alt="a" src="/build/assets/images/Pic1-797f949cb9cadc7642fe487268060c1a.png"></p><p>Click create a new app and give it a name, click create. You should be taken to the home page which looks like the below. In the next steps, you will need the Application (client) ID and the Directory (tenent) ID that are stated in the overview at the top.
<img alt="a" src="/build/assets/images/Pic2-224c2d62138a64b9c05a2c6732430bcd.png"></p><p>Now we need to adjust some settings.
Go to authentication. Click add a platform, select web. You will need to add a redirect url, use: <a href="https://login.live.com/oauth20_desktop.srf" target="_blank" rel="noopener noreferrer">https://login.live.com/oauth20_desktop.srf</a> which is the standard Microsoft AD login
Still under authentication, under supported account types, click Accounts in my organization directory (multi-tenent)
<img alt="a" src="/build/assets/images/Pic3-679b777fbf315d3311ef7e691272b95e.png"></p><p>Next go to the Certificates and secrets section. You will need to create a new client secret. WRITE DOWN THE VALUE, you will not be able to see it again.
<img alt="a" src="/build/assets/images/Pic4-fa8c6573729f24d195c9011745a264eb.png"></p><p>Next go to API permissions. Add a permission for Dynamics CRM with the user_impersonation permission.
<img alt="a" src="/build/assets/images/Pic5-9a72c67f8bb4e33ff02f66c47e2377f6.png"></p><p>Go to the owner section. If necessary, add another owner to your app. Those with access to all apps will be able to see your app, so in this area you just will add additional people who will need access.
<img alt="a" src="/build/assets/images/Pic6-2a0a102bfe705b4b47108308e53516b5.png"></p><p>Now, a very important step! Go to Manifest, find the line that says oauth2AllowIdTokenIDImplicitflow and change false to true. Also change the line oauth2AllowImplicitflow the same way.
<img alt="a" src="/build/assets/images/Pic7-5b13c5d3ecdbe0a0b75f71e893eab13b.png"></p><p>Now your app is ready for use. From here you can either continue to follow the steps for creating your own Alteryx macro, or install the general tool to pull out one table at a time</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="using-the-api-in-postman-with-oauth2"></a>Using the API in Postman with OAUTH2<a class="hash-link" href="#using-the-api-in-postman-with-oauth2" title="Direct link to heading">#</a></h3><p>Create an environment:
<img alt="a" src="/build/assets/images/Pic8-f475b2d67d19b208c4b587a9122f3496.png"></p><p>Set up OAuth2 to get your token:
<img alt="a" src="/build/assets/images/Pic9-2d84368a98285d22fbe7664ef11964b6.png"></p><p>Use the access token to test. Here I am using the “EntitityDefinitions” call to test, which gives you a list of all of the tables or “entities” as they are called in Dynamics CRM. No body or headers are needed. </p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="using-the-api-in-alteryx"></a>Using the API in Alteryx<a class="hash-link" href="#using-the-api-in-alteryx" title="Direct link to heading">#</a></h5><p>To use the API in Alteryx, we will need to use postman to get an initial access and refresh token. Once we have the refresh token, we can create an Alteryx macro to log in and call the API.</p><p>To get the initial token, you first need to get a “code” which is one of the required headers in Postman. This is the weirdest part. </p><p>Using the following link, fill out your relevant information in the link:
The information can be found on your Azure page.</p><p>login.microsoftonline.com/common/oauth2/authorize?resource=THE_SITE_YOU_WANT_TO_ACCESS_BY_API&amp;client_id=YOUR_CLIENT_ID&amp;response_type=code&amp;redirect_uri=YOUR_CALLBACK_URL</p><p>Ours looked like:
login.microsoftonline.com/common/oauth2/authorize%3Fresource=<a href="https://COMPANYNAMEcrm.crm4.dynamics.com&amp;client_id=fdHIDDENef&amp;response_type=code&amp;redirect_uri=https://login.live.com/oauth20_desktop.srf" target="_blank" rel="noopener noreferrer">https://COMPANYNAMEcrm.crm4.dynamics.com&amp;client_id=fdHIDDENef&amp;response_type=code&amp;redirect_uri=https://login.live.com/oauth20_desktop.srf</a></p><p>Note: You might need to do this on a windows computer, it did not work on a mac</p><p>This will probably return a page that cannot be reached - but don’t worry! Look at the URL address line - it should now be something like this:</p><p>//callbackurl/?code=AIADCEemlorJHF0R7FNsb_LXwNe4DF3kEMnDAeRJFf4h52FkfsJK223vPNfjU8fBDoub1l_glaFKEmET34SV5aFHaBJ-kRiAE34FaeFGgAA&amp;session_state=15634a4g6-0k8f-4632-b756-g757e3e9ekd2</p><p>What you need from this is code after ?code= and before &amp;session_state= (it will probably be much longer!)</p><p>Now back to Postman
Fill out a call like this. (note it is post, and is encoding. There are no headers)
<img alt="a" src="/build/assets/images/Pic10-b08a756f60f401de1453e1499373aeba.png"></p><p>NOW, out of the response from this, we will only use the refresh_token, and now it is finally time to head to Alteryx. </p><h6><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="alteryx-macro-setup"></a>Alteryx Macro Setup<a class="hash-link" href="#alteryx-macro-setup" title="Direct link to heading">#</a></h6><p>If you haven&#x27;t yet downloaded the Alteryx macros the link can be found at the top. </p><p>What we will do is create a macro that fetches us an access code by using the refresh code. Every time we get a new access code, we also get a new refresh code, which we will then use until the next time we get a new access code. First we create a file with our necessary fields. Then we call the API. Then we take the new refresh token and replace the old one in the file. This becomes our input for next time. </p><p>Overall authentication flow:
<img alt="a" src="/build/assets/images/Pic11-952f1949fdc0895301ea0414664a05ac.png"></p><p>Contents of the input file:
<img alt="a" src="/build/assets/images/Pic12-41a935b9bca25191c1ae3ee1377cbfff.png"></p><p>Download tool settings:</p><p><img alt="a" src="/build/assets/images/Pic13-fb2dace0f8e230fcab3d0068f3e90e10.png">
<img alt="a" src="/build/assets/images/Pic14-2f76a91ef880fe528a719523b8a8470a.png"></p><p>Now we have a macro to authenticate for us in Alteryx. Below we use our authentication macro to get the access code it is output by the macro in a column named “Authorization”. We append that code to the URL we are going to call, in this case we are going to download the EntityDefinitions like we did before.
<img alt="a" src="/build/assets/images/Pic15-9ea47a9a7f87d9db8ef621ca6be25038.png"></p><p>The download tool setup:</p><p><img alt="a" src="/build/assets/images/Pic16-c69fcc542b28351c2ac444923ccf83af.png">
<img alt="a" src="/build/assets/images/Pic17-d0f26456daf856618ee80ff434258d06.png">
<img alt="a" src="/build/assets/images/Pic18-4eb95d087438879421080efc0ad0ffaf.png"></p><p>And FINALLY, we have data from Dynamics CRM :) </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="creating-your-own-macro--using-the-provided-macros"></a>Creating your own macro / Using the provided macros<a class="hash-link" href="#creating-your-own-macro--using-the-provided-macros" title="Direct link to heading">#</a></h3><p>The macros folder at the top contain 3 macros.
The first DynamicsGetBearerToken as the name suggests is used to get a refresh token for each time you call Dynamics. This will have to be set up as described above. Once this is done the two other macros can be used:</p><ol><li><p>DynamicstoFlow::
This one takes an entity you want to download and outputs it to your workflow</p></li><li><p>DynamicstoSnowflake:
This one takes a list of entities you want to downloads, and outputs them each individually to a RAW table on snowflake.
The Snowflake credentials for the desired output will need to be intered here. </p></li></ol><p>Note: This macro maxes out at 5000 records returned from the API. As of writing there has not been a case where more were needed. If more records are present, a workaround needs to be created. </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="alternative-the-alteryx-gallery-dynamics-tool"></a>Alternative: The Alteryx Gallery Dynamics tool.<a class="hash-link" href="#alternative-the-alteryx-gallery-dynamics-tool" title="Direct link to heading">#</a></h3><p>The Alteryx Gallery also has a dynamics tool which also requires you to set up the app. However this tool has the drawback of being quite heavy and thereby making Alteryx run super slow, but it can be usefull if you only need one or few entities. To set this up <a href="https://gallery.alteryx.com/#!app/Dynamics-CRM-Tools/5b1f09660462d72900a250e6" target="_blank" rel="noopener noreferrer">download the macro from the gallery</a> and do the following:</p><ol><li>Download the yxi file from the gallery.</li><li>Rename the extension from .YXI to .ZIP</li><li>Extract the zip file</li><li>Locate requirements.txt file within Input/Output Tool folders.</li><li>Open and edit requirments.txt file to add cryptography==2.9.2 as the last line for both Input and Output folders.</li><li>Save/update file.</li><li>Rename the extension from .ZIP to .YXI</li><li>Run the installer</li></ol><p>After installing the macro in Alteryx the input and output macros for dynamics will be under connectors in your toolbar</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/docs/Connections/Microsoft Dynamics.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/build/docs/Connections/Maconomy"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Maconomy</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/build/docs/Connections/Oracle"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Oracle Databases »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#alteryx-to-microsoft-dynamics-crm" class="table-of-contents__link">Alteryx to Microsoft Dynamics CRM</a></li><li><a href="#initial-setup" class="table-of-contents__link">Initial setup</a><ul><li><a href="#azure-ad-app" class="table-of-contents__link">Azure AD App</a></li><li><a href="#using-the-api-in-postman-with-oauth2" class="table-of-contents__link">Using the API in Postman with OAUTH2</a></li><li><a href="#creating-your-own-macro--using-the-provided-macros" class="table-of-contents__link">Creating your own macro / Using the provided macros</a></li><li><a href="#alternative-the-alteryx-gallery-dynamics-tool" class="table-of-contents__link">Alternative: The Alteryx Gallery Dynamics tool.</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/build/docs/intro">Designer</a></li></ul></div></div><div class="footer__bottom text--center"></div></div></footer></div>
<script src="/build/assets/js/runtime~main.11a58632.js"></script>
<script src="/build/assets/js/main.5de3d1d2.js"></script>
</body>
</html>